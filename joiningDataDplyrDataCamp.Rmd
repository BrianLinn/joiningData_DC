---
title: "Joining Data in R with Dplyr"
output: html_notebook
---

#Joining Data in R with Dplyr

##Mutating Joins

left-join
right-join
inner-join
full-join

###A basic join
As Garrett mentioned in the video, left_join() is the basic join function in dplyr. You can use it whenever you want to augment a data frame with information from another data frame.

For example, left_join(x, y) joins y to x. The second dataset you specify is joined to the first dataset. Keep that in mind as you go through the course.

For this exercise, the code in the editor sets up a left join but doesn't finish it. It's up to you to complete it.

####A second join
100xp
You should always check the output of your joins. Just because a join worked, doesn't mean that it worked as you expected.

For example, the code in the editor joins the same two datasets that you joined in the previous exercise, but it returns a different result. Can you tell what went wrong?
```{r leftJoin}
library(tidyverse)
artists <- read_csv("./data/artists.csv")
bands <- read_csv("./data/bands.csv")

# Complete the code to join artists to bands
bands2 <- left_join(bands, artists, by = c("first", "last"))

# Examine the results
bands2

# Fix the code to recreate bands2
left_join(bands, artists, by = "first")
left_join(bands, artists, by = c("first", "last"))

```
###A right join
There is more than one way to execute a left join. Knowing multiple methods will make you a more versatile data scientist, especially as you try to fit joins into pipes created with %>%.

In this exercise, you'll recreate bands2 once more, but this time without using a left_join().
```{r rightJoin}
# Finish the code below to recreate bands3 with a right join
bands2 <- left_join(bands, artists, by = c("first", "last"))
bands3 <- right_join(artists, bands, by = c("first", "last"))

# Check that bands3 is equal to bands2
setequal(bands2, bands3)


```

###Inner joins and full joins
You may have noticed that some of the songs in songs correspond to some of the albums in albums. Suppose you want a new dataset that contains all of the songs for which you have data from both albums and songs. How would you make it?

The artists and bands datasets also share some information. What if you want to join these two datasets in such a way that you retain all of the information available in both tables, without throwing anything away?

You can think of inner joins as the most strict type of join: they only retain observations that appear in both datasets. In contrast, full joins are the most permissive type of join: they return all of the data that appears in both datasets (often resulting in many missing values).

Recall that, *_join(x, y) joins y to x. The second dataset you specify is joined to the first dataset.

```{r innerFullJoin}
albums <- read_csv("./data/albums.csv")
songs <- read_csv("./data/songs.csv")
# Join albums to songs using inner_join()
inner_join(songs, albums, by = "album")

# Join bands to artists using full_join()
full_join(artists, bands, by = c("first", "last"))

```

###Pipes
You can combine dplyr functions together with the pipe operator, %>%, to build up an analysis step-by-step. %>% takes the result of the code that comes before it and "pipes" it into the function that comes after it as the first argument of the function.

So for example, the two pieces of code below do the same thing:

full_join(artists, bands, 
          by = c("first", "last"))

artists %>% 
  full_join(bands, by = c("first", "last"))
Pipes are so efficient for multi-step analysis that you will use them for the remainder of the exercises in this course. (If you need a refresher on the pipe operator, check out Data Manipulation in R with dplyr course!)
```{r pipes}
# Find guitarists in bands dataset (don't change)
temp <- left_join(bands, artists, by = c("first", "last"))
temp <- filter(temp, instrument == "Guitar")
select(temp, first, last, band)

# Reproduce code above using pipes
bands %>% 
  left_join(artists, by = c("first", "last")) %>%
  filter(instrument == "Guitar") %>%
  select(first, last, band)


goal <- as_tibble(read_csv("./data/goal.csv"))
# Examine the contents of the goal dataset
goal

# Create goal2 using full_join() and inner_join() 
goal2 <- artists %>% 
        full_join(bands, by = c("first", "last")) %>%
        inner_join(songs, by = c("first", "last"))
        
str(goal2)  
  
# Check that goal and goal2 are the same
setequal(goal, goal2)

# Create one table that combines all information
artists %>% 
        full_join(bands, by = c("first", "last")) %>%
        full_join(songs, by = c("first", "last")) %>%
        full_join(albums, by = c("album","band"))
```

##Filtering Joins and Set Operators

